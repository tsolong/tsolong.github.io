import{_ as e,M as p,p as o,q as c,R as s,t as n,N as l,a1 as a}from"./framework-cf3d8b6f.js";const i={},r=a('<h1 id="数据库表设计" tabindex="-1"><a class="header-anchor" href="#数据库表设计" aria-hidden="true">#</a> 数据库表设计</h1><div class="custom-container tip"><p class="custom-container-title">介绍</p><p>Mineadmin具有强大的自动生成前后端代码功能，后台功能<code>工具-&gt;代码生成器</code>。</p><p>为了方便使用和配置自动生成器，我们设计了一套表备注来帮助生成代码</p></div><h2 id="主键设计选择" tabindex="-1"><a class="header-anchor" href="#主键设计选择" aria-hidden="true">#</a> 主键设计选择</h2><h3 id="雪花id主键-snowflake" tabindex="-1"><a class="header-anchor" href="#雪花id主键-snowflake" aria-hidden="true">#</a> 雪花ID主键 Snowflake</h3>',4),u={href:"https://hyperf.wiki/2.2/#/zh-cn/snowflake?id=snowflake",target:"_blank",rel:"noopener noreferrer"},k=a(`<div class="language-SQL-DDL line-numbers-mode" data-ext="SQL-DDL"><pre class="language-SQL-DDL"><code>\`id\` bigint(20) NOT NULL
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">为什么使用雪花ID，使用雪花ID有什么好处</p><p>使用雪花算法生成ID的好处包括： 全局唯一性，高性能，趋势递增，分布式</p><p>一个案例来说明在开发中使用雪花ID的好处，这个案例我们可以看出，使用雪花ID我们并不需要担心在代码逻辑中批量生成ID时候，ID重复的情况，也就是说我们在开发中，只需要关系数据的写入时候ID是否关联上，这是自增ID很难做到的点。</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token comment">// 生成订单数据</span>
<span class="token keyword">function</span> <span class="token function-definition function">generateOrders</span><span class="token punctuation">(</span><span class="token variable">$count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$orders</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$count</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$order</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;id&#39;</span> <span class="token operator">=&gt;</span> <span class="token function">snowflake_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 使用雪花算法生成唯一ID</span>
            <span class="token string single-quoted-string">&#39;user_id&#39;</span> <span class="token operator">=&gt;</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 假设用户ID在1到100之间</span>
            <span class="token string single-quoted-string">&#39;created_at&#39;</span> <span class="token operator">=&gt;</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Y-m-d H:i:s&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;updated_at&#39;</span> <span class="token operator">=&gt;</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Y-m-d H:i:s&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$orders</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$order</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token variable">$orders</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 生成订单商品数据</span>
<span class="token keyword">function</span> <span class="token function-definition function">generateOrderItems</span><span class="token punctuation">(</span><span class="token variable">$order_id</span><span class="token punctuation">,</span> <span class="token variable">$count</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$orderItems</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$count</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$orderItem</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&#39;id&#39;</span> <span class="token operator">=&gt;</span> <span class="token function">snowflake_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;order_id&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$order_id</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;product_id&#39;</span> <span class="token operator">=&gt;</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 假设商品ID在1到50之间</span>
            <span class="token string single-quoted-string">&#39;quantity&#39;</span> <span class="token operator">=&gt;</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;created_at&#39;</span> <span class="token operator">=&gt;</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Y-m-d H:i:s&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&#39;updated_at&#39;</span> <span class="token operator">=&gt;</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;Y-m-d H:i:s&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$orderItems</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$orderItem</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token variable">$orderItems</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 一次性生成并插入订单数据和订单商品数据</span>
<span class="token variable">$count</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">// 假设要插入10个订单</span>
<span class="token variable">$orders</span> <span class="token operator">=</span> <span class="token function">generateOrders</span><span class="token punctuation">(</span><span class="token variable">$count</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$orderItems</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$orders</span> <span class="token keyword">as</span> <span class="token variable">$order</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$orderItems</span> <span class="token operator">=</span> <span class="token function">array_merge</span><span class="token punctuation">(</span><span class="token variable">$orderItems</span><span class="token punctuation">,</span> <span class="token function">generateOrderItems</span><span class="token punctuation">(</span><span class="token variable">$order</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 每个订单插入1到3个商品</span>
<span class="token punctuation">}</span>

<span class="token class-name static-context">Db</span><span class="token operator">::</span><span class="token function">transaction</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">use</span> <span class="token punctuation">(</span><span class="token variable">$orders</span><span class="token punctuation">,</span> <span class="token variable">$orderItems</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name static-context">Db</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;orders&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token variable">$orders</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name static-context">Db</span><span class="token operator">::</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;order_items&#39;</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token variable">$orderItems</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h3 id="自增主键" tabindex="-1"><a class="header-anchor" href="#自增主键" aria-hidden="true">#</a> 自增主键</h3><p>数据库自带的自增ID</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token identifier"><span class="token punctuation">\`</span>id<span class="token punctuation">\`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="表字段类型设置以及字段备注" tabindex="-1"><a class="header-anchor" href="#表字段类型设置以及字段备注" aria-hidden="true">#</a> 表字段类型设置以及字段备注</h2><h3 id="字段名" tabindex="-1"><a class="header-anchor" href="#字段名" aria-hidden="true">#</a> 字段名</h3><table><thead><tr><th style="text-align:center;">字段名</th><th style="text-align:center;">例如</th><th style="text-align:center;">输入框类型</th></tr></thead><tbody><tr><td style="text-align:center;">image</td><td style="text-align:center;">mine_image</td><td style="text-align:center;">单图片上传</td></tr><tr><td style="text-align:center;">images</td><td style="text-align:center;">mine_images</td><td style="text-align:center;">多图片上传</td></tr><tr><td style="text-align:center;">file</td><td style="text-align:center;">mine_file</td><td style="text-align:center;">单文件上传</td></tr><tr><td style="text-align:center;">files</td><td style="text-align:center;">mine_files</td><td style="text-align:center;">多文件上传</td></tr></tbody></table><h3 id="字段数据类型" tabindex="-1"><a class="header-anchor" href="#字段数据类型" aria-hidden="true">#</a> 字段数据类型</h3><table><thead><tr><th style="text-align:center;">字段类型</th><th style="text-align:center;">搜索标识符</th><th style="text-align:center;">输入框类型</th><th style="text-align:center;">表备注</th></tr></thead><tbody><tr><td style="text-align:center;">tinyint、int、bigint</td><td style="text-align:center;">eq</td><td style="text-align:center;">数字输入框、选择输入框</td><td style="text-align:center;">类型:1=类型1,2=类型2</td></tr><tr><td style="text-align:center;">varchar</td><td style="text-align:center;">like</td><td style="text-align:center;">文本输入框</td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">text、longtext</td><td style="text-align:center;">no</td><td style="text-align:center;">富文本</td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">timestamp、datetime</td><td style="text-align:center;">between</td><td style="text-align:center;">日期时间组件</td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">date</td><td style="text-align:center;">between</td><td style="text-align:center;">日期组件</td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">json</td><td style="text-align:center;">no</td><td style="text-align:center;">无</td><td style="text-align:center;"></td></tr></tbody></table><h2 id="示例ddl" tabindex="-1"><a class="header-anchor" href="#示例ddl" aria-hidden="true">#</a> 示例DDL</h2><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">\`</span>print_test<span class="token punctuation">\`</span></span>  <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">\`</span>id<span class="token punctuation">\`</span></span> <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>type<span class="token punctuation">\`</span></span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;类型:1=是,0=否&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>conetnt<span class="token punctuation">\`</span></span> <span class="token keyword">text</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;富文本&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>image<span class="token punctuation">\`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_general_ci <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;图片上传&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>file<span class="token punctuation">\`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_general_ci <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;文件上传&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>images<span class="token punctuation">\`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_general_ci <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;多图片上传&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>files<span class="token punctuation">\`</span></span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_general_ci <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;多文件上传&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>datetime<span class="token punctuation">\`</span></span> <span class="token keyword">datetime</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;日期时间&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>date<span class="token punctuation">\`</span></span> <span class="token keyword">date</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;日期&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>user_id<span class="token punctuation">\`</span></span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;用户&#39;</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">\`</span>json<span class="token punctuation">\`</span></span> json <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;数组&#39;</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">\`</span>id<span class="token punctuation">\`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span><span class="token punctuation">,</span>
  <span class="token keyword">INDEX</span> <span class="token identifier"><span class="token punctuation">\`</span>user_id_index<span class="token punctuation">\`</span></span><span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">\`</span>user_id<span class="token punctuation">\`</span></span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> utf8mb4 <span class="token keyword">COLLATE</span> <span class="token operator">=</span> utf8mb4_general_ci <span class="token keyword">COMMENT</span> <span class="token operator">=</span> <span class="token string">&#39;测试表&#39;</span> ROW_FORMAT <span class="token operator">=</span> Dynamic<span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,12);function d(v,b){const t=p("ExternalLinkIcon");return o(),c("div",null,[r,s("p",null,[n("雪花ID，使用的hyperf官方提供的包，具体算法设计模式可以查看"),s("a",u,[n("链接"),l(t)]),n(" 非自增ID，mineadmin就会自动维护生成")]),k])}const g=e(i,[["render",d],["__file","table.html.vue"]]);export{g as default};
